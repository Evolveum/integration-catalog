<!--
 * Copyright (c) 2010-2025 Evolveum and contributors
 *
 * Licensed under the EUPL-1.2 or later.
 -->

@if (isOpen()) {
  <div class="modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1040;" (click)="closeModal()"></div>
  <div class="modal" style="display: block; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1050; overflow: auto;" (click)="closeModal()">
    <div class="modal-dialog modal-dialog-centered" style="max-width: 800px; margin: auto;">
      <div class="modal-content" (click)="$event.stopPropagation()" style="border-radius: 12px;">

        <div class="d-flex" style="min-height: 500px;">
          <!-- Left Sidebar -->
          <div class="filter-sidebar" style="width: 250px; min-width: 250px; flex-shrink: 0; background-color: #f8f9fa; border-right: 1px solid #dee2e6; border-radius: 12px 0 0 12px; padding: 1.5rem 0;">
            <!-- <div
              class="filter-option"
              [class.active]="selectedSection() === 'trending'"
              (click)="selectSection('trending')"
              style="padding: 0.75rem 1.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.75rem;"
              [style.background-color]="selectedSection() === 'trending' ? '#e9ecef' : 'transparent'">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-graph-up" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M0 0h1v15h15v1H0zm14.817 3.113a.5.5 0 0 1 .07.704l-4.5 5.5a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61 4.15-5.073a.5.5 0 0 1 .704-.07"/>
              </svg>
              <span>Trending</span>
            </div> -->

            <div
              class="filter-option"
              [class.active]="selectedSection() === 'categories'"
              (click)="selectSection('categories')"
              style="padding: 0.75rem 1.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.75rem;"
              [style.background-color]="selectedSection() === 'categories' ? '#e9ecef' : 'transparent'">
              <img [src]="selectedSection() === 'categories' ? 'copy selected.svg' : 'copy.svg'" alt="" width="24" height="24">
              <span style="font-weight: 600;">Categories</span>
            </div>

            <div
              class="filter-option"
              [class.active]="selectedSection() === 'capabilities'"
              (click)="selectSection('capabilities')"
              style="padding: 0.75rem 1.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.75rem;"
              [style.background-color]="selectedSection() === 'capabilities' ? '#e9ecef' : 'transparent'">
              <img [src]="selectedSection() === 'capabilities' ? 'puzzle-line selected.svg' : 'ri_puzzle-line.svg'" alt="" width="24" height="24">
              <span style="font-weight: 600;">Capabilities</span>
            </div>

            <div
              class="filter-option"
              [class.active]="selectedSection() === 'midpoint'"
              (click)="selectSection('midpoint')"
              style="padding: 0.75rem 1.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.75rem;"
              [style.background-color]="selectedSection() === 'midpoint' ? '#e9ecef' : 'transparent'">
              <img [src]="selectedSection() === 'midpoint' ? 'octicon_versions selected.svg' : 'octicon_versions-16.svg'" alt="" width="24" height="24">
              <span style="font-weight: 600;">MidPoint version</span>
            </div>

            <div
              class="filter-option"
              [class.active]="selectedSection() === 'appstatus'"
              (click)="selectSection('appstatus')"
              style="padding: 0.75rem 1.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.75rem;"
              [style.background-color]="selectedSection() === 'appstatus' ? '#e9ecef' : 'transparent'">
              <img [src]="selectedSection() === 'appstatus' ? 'tag-outline selected.svg' : 'mdi_tag-outline.svg'" alt="" width="24" height="24">
              <span style="font-weight: 600;">App status</span>
            </div>

            <div
              class="filter-option"
              [class.active]="selectedSection() === 'integration'"
              (click)="selectSection('integration')"
              style="padding: 0.75rem 1.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.75rem;"
              [style.background-color]="selectedSection() === 'integration' ? '#e9ecef' : 'transparent'">
              <img [src]="selectedSection() === 'integration' ? 'integration method selected.svg' : 'material-symbols_integration-instructions-outline-rounded.svg'" alt="" width="24" height="24">
              <span style="font-weight: 600;">Integration method</span>
            </div>
          </div>

          <!-- Right Content -->
          <div class="filter-content flex-grow-1" style="padding: 2rem;">
            <!-- Trending -->
            <!-- @if (selectedSection() === 'trending') {
              <div>
                <h5 class="mb-4">Trending</h5>
                <div>
                  <span
                    class="badge"
                    [class.selected]="trending()"
                    (click)="toggleTrending()"
                    style="font-size: 0.875rem; padding: 0.5rem 1rem; cursor: pointer; border-radius: 20px; font-weight: normal;"
                    [style.border]="trending() ? '1px solid #2722c7' : '1px solid #a6a6a6'"
                    [style.background-color]="trending() ? '#f2f2f2' : 'white'"
                    [style.color]="trending() ? '#0c3c85' : '#212529'">
                    Popular
                  </span>
                </div>
              </div>
            } -->

            <!-- Categories -->
            @if (selectedSection() === 'categories') {
              <div>
                <h5 class="mb-4">Categories</h5>
                <div class="category-list">
                  @for (category of categories(); track category.name) {
                    <div
                      class="category-item d-flex justify-content-between align-items-center py-2 px-3"
                      (click)="toggleCategory(category.name)"
                      style="cursor: pointer; border-radius: 4px; margin-bottom: 0.5rem;"
                      [style.background-color]="isCategorySelected(category.name) ? '#dee2e6' : 'transparent'">
                      <span>{{ category.displayName }}</span>
                      <span class="text-muted">{{ category.count }}</span>
                    </div>
                  }
                </div>
              </div>
            }

            <!-- Capabilities -->
            @if (selectedSection() === 'capabilities') {
              <div>
                <h5 class="mb-4">Capabilities</h5>
                <div class="d-flex flex-wrap gap-2">
                  @for (capability of capabilities; track capability) {
                    <span
                      class="badge capability-badge"
                      [class.selected]="isCapabilitySelected(capability)"
                      (click)="toggleCapability(capability)"
                      style="font-size: 0.875rem; padding: 0.5rem 1rem; cursor: pointer; border-radius: 20px; font-weight: normal;"
                      [style.border]="'1px solid ' + (isCapabilitySelected(capability) ? '#206f9d' : '#ced4da')"
                      [ngStyle]="{
                        boxShadow: isCapabilitySelected(capability) ? '0 0 0 1px #206f9d' : 'none'
                      }"
                      [style.background-color]="isCapabilitySelected(capability) ? '#f2f2f2' : 'white'"
                      [style.color]="isCapabilitySelected(capability) ? '#206f9d' : '#212529'">
                      {{ formatCapability(capability) }}
                    </span>
                  }
                </div>
              </div>
            }

            <!-- MidPoint Version -->
            @if (selectedSection() === 'midpoint') {
              <div>
                <h5 class="mb-4">MidPoint version</h5>
                <div class="d-flex flex-wrap gap-2">
                  @for (version of midpointVersions(); track version) {
                    <span
                      class="badge version-badge"
                      [class.selected]="isMidpointVersionSelected(version)"
                      (click)="toggleMidpointVersion(version)"
                      style="font-size: 0.875rem; padding: 0.5rem 1rem; cursor: pointer; border-radius: 20px; font-weight: normal;"
                      [[style.border]="'1px solid ' + (isMidpointVersionSelected(version) ? '#206f9d' : '#ced4da')"
                      [ngStyle]="{
                        boxShadow: isMidpointVersionSelected(version) ? '0 0 0 1px #206f9d' : 'none'
                      }"
                      [style.background-color]="isMidpointVersionSelected(version) ? '#f2f2f2' : 'white'"
                      [style.color]="isMidpointVersionSelected(version) ? '#206f9d' : '#212529'">
                      {{ version }}
                    </span>
                  } @empty {
                    <p class="text-muted">No MidPoint versions available</p>
                  }
                </div>
              </div>
            }

            <!-- App Status -->
            @if (selectedSection() === 'appstatus') {
              <div>
                <h5 class="mb-4">App status</h5>
                <div class="d-flex flex-wrap gap-2">
                  @for (status of appStatuses; track status.name) {
                    <span
                      class="badge status-badge"
                      [class.selected]="isAppStatusSelected(status.name)"
                      (click)="toggleAppStatus(status.name)"
                      style="font-size: 0.875rem; padding: 0.5rem 1rem; cursor: pointer; border-radius: 20px; font-weight: normal;"
                      [style.border]="'1px solid ' + (isAppStatusSelected(status.name) ? '#206f9d' : '#ced4da')"
                      [ngStyle]="{
                        boxShadow: isAppStatusSelected(status.name) ? '0 0 0 1px #206f9d' : 'none'
                      }"
                      [style.background-color]="isAppStatusSelected(status.name) ? '#f2f2f2' : 'white'"
                      [style.color]="isAppStatusSelected(status.name) ? '#206f9d' : '#212529'">
                      {{ status.displayName }}
                    </span>
                  }
                </div>
              </div>
            }

            <!-- Integration Method -->
            @if (selectedSection() === 'integration') {
              <div>
                <h5 class="mb-4">Integration method</h5>
                <div class="d-flex flex-wrap gap-2">
                  @for (method of integrationMethods; track method) {
                    <span
                      class="badge integration-badge"
                      [class.selected]="isIntegrationMethodSelected(method)"
                      (click)="toggleIntegrationMethod(method)"
                      style="font-size: 0.875rem; padding: 0.5rem 1rem; cursor: pointer; border-radius: 20px; font-weight: normal;"
                      [style.border]="'1px solid ' + (isIntegrationMethodSelected(method) ? '#206f9d' : '#ced4da')"
                      [ngStyle]="{
                        boxShadow: isIntegrationMethodSelected(method) ? '0 0 0 1px #206f9d' : 'none'
                      }"
                      [style.background-color]="isIntegrationMethodSelected(method) ? '#f2f2f2' : 'white'"
                      [style.color]="isIntegrationMethodSelected(method) ? '#206f9d' : '#212529'">
                      {{ method }}
                    </span>
                  }
                </div>
              </div>
            }
          </div>
        </div>

      </div>
    </div>
  </div>
}
