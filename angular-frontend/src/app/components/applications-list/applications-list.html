<div class="container-fluid p-0" style="background-color: #e9ecef;">
  <!-- Hero Banner -->
  <div class="bg-primary text-white py-5 mb-5" style="background: linear-gradient(135deg, #2c5282 0%, #4a7ba7 100%);">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-6">
          <h1 class="display-4 fw-bold mb-3">Integration Catalog</h1>
          <p class="lead mb-4">Easily connect any application or system to midpoint</p>
          <p class="mb-2">Explore available integrations to jump-start your workflow, build your own AI-guided assistance,</p>
          <p class="mb-0">or upload an existing configuration to get started in just minutes. The process is fast, flexible, and user-friendly.</p>
        </div>
        <div class="col-lg-6 text-center">
          <!-- Placeholder for illustration/graphic -->
          <div class="d-flex justify-content-center align-items-center" style="min-height: 250px;">
            <svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" fill="currentColor" class="opacity-50" viewBox="0 0 16 16">
              <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
            </svg>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container py-4" style="background-color: #e9ecef;">

  <div class="row mb-5">
    <div class="col-lg-6 mx-auto">
      <div class="d-flex gap-2 align-items-center">
        <div class="input-group flex-grow-1">
          <span class="input-group-text bg-white border-end-0" style="border-radius: 50px 0 0 50px;">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
              <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
            </svg>
          </span>
          <input
            type="text"
            class="form-control border-start-0"
            placeholder="Search for integrations..."
            [value]="searchQuery()"
            (input)="onSearchChange($event)"
            style="border-radius: 0 50px 50px 0;"
          />
        </div>
        <button class="btn rounded-circle d-flex align-items-center justify-content-center" type="button" title="Filter" style="background-color: white; border: 1px solid #ced4da; width: 38px; height: 38px; padding: 0;">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sliders" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M11.5 2a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM9.05 3a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0V3h9.05zM4.5 7a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM2.05 8a2.5 2.5 0 0 1 4.9 0H16v1H6.95a2.5 2.5 0 0 1-4.9 0H0V8h2.05zm9.45 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm-2.45 1a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0v-1h9.05z"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <h2 class="h3 mb-4 text-center">Featured integration apps</h2>

  @if (loading()) {
    <div class="d-flex justify-content-center my-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
  }

  @if (error()) {
    <div class="alert alert-danger" role="alert">{{ error() }}</div>
  }

  @if (!loading() && !error()) {
    <div class="position-relative mb-5">
      <button class="btn rounded-circle position-absolute top-50 start-0 translate-middle-y d-flex align-items-center justify-content-center"
              style="z-index: 10; width: 40px; height: 40px; padding: 0; background-color: white; border: 2px solid #dee2e6;"
              (click)="scrollLeft()"
              [disabled]="!canScrollLeft()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
        </svg>
      </button>

      <div class="scroll-container" #scrollContainer (scroll)="onScroll()" style="overflow-x: auto; scroll-behavior: smooth;">
        <div class="d-flex gap-3 px-5">
          @for (app of featuredApplications(); track app.id) {
            <div class="card position-relative" style="min-width: 250px; max-width: 250px;">
              @if (app.tags && app.tags.length > 0) {
                @for (tag of app.tags; track tag.id) {
                  @if (tag.name === 'popular') {
                    <span class="badge bg-warning text-dark position-absolute top-0 end-0 m-2" style="font-size: 0.7rem;">{{ tag.displayName }}</span>
                  }
                }
              }
              <img [src]="app.logo" alt="" class="p-3" style="width: 150px; height: 150px; object-fit: contain;" />
              <div class="card-body d-flex flex-column">
                <h5 class="card-title">{{ app.displayName }}</h5>
                @if (app.lifecycleState) {
                  <span class="badge bg-success mb-2 align-self-start">{{ formatLifecycleState(app.lifecycleState) }}</span>
                }
                <p class="card-text text-muted small flex-grow-1">{{ app.description }}</p>
                <button class="btn btn-primary btn-sm mt-2" (click)="navigateToDetail(app.id)">View Details</button>
              </div>
            </div>
          }
        </div>
      </div>

      <button class="btn rounded-circle position-absolute top-50 end-0 translate-middle-y d-flex align-items-center justify-content-center"
              style="z-index: 10; width: 40px; height: 40px; padding: 0; background-color: white; border: 2px solid #dee2e6;"
              (click)="scrollRight()"
              [disabled]="!canScrollRight()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
        </svg>
      </button>
    </div>

    <div class="position-relative mb-4">
      <div class="text-center">
        <h2 class="h3 mb-1">More apps</h2>
        <p class="text-muted mb-0">Showing {{ filteredCount() }} integrations</p>
      </div>
      <div class="position-absolute top-50 end-0 translate-middle-y">
        <div class="d-flex align-items-center gap-3">
        <div class="d-flex align-items-center gap-2">
          <label class="mb-0 text-muted text-nowrap">Sort by</label>
          <select class="form-select form-select-sm" [value]="sortBy()" (change)="onSortChange($event)">
            <option value="alphabetical">Alphabetical</option>
            <option value="popularity">Popularity</option>
            <option value="activity">Activity</option>
          </select>
        </div>

        <div class="btn-group" role="group">
          <button
            type="button"
            class="btn btn-sm"
            [class.btn-primary]="viewMode() === 'grid'"
            [class.btn-outline-secondary]="viewMode() !== 'grid'"
            (click)="setViewMode('grid')"
            title="Grid view"
          >
            ⊞
          </button>
          <button
            type="button"
            class="btn btn-sm"
            [class.btn-primary]="viewMode() === 'list'"
            [class.btn-outline-secondary]="viewMode() !== 'list'"
            (click)="setViewMode('list')"
            title="List view"
          >
            ☰
          </button>
        </div>
        </div>
      </div>
    </div>

    @if (viewMode() === 'grid') {
      <div class="row g-4 mb-4">
        @for (app of moreApplications(); track app.id) {
          <div class="col-12 col-sm-6 col-md-4 col-lg-3">
            <div class="card h-100 shadow-sm position-relative">
              @if (app.tags && app.tags.length > 0) {
                @for (tag of app.tags; track tag.id) {
                  @if (tag.name === 'popular') {
                    <span class="badge bg-warning text-dark position-absolute top-0 end-0 m-2" style="font-size: 0.7rem;">{{ tag.displayName }}</span>
                  }
                }
              }
              <img [src]="app.logo" alt="" class="p-3" style="width: 150px; height: 150px; object-fit: contain;" />
              <div class="card-body d-flex flex-column">
                <h5 class="card-title">{{ app.displayName }}</h5>
                @if (app.lifecycleState) {
                  <span class="badge bg-success mb-2 align-self-start">{{ formatLifecycleState(app.lifecycleState) }}</span>
                }
                <p class="card-text text-muted small flex-grow-1">{{ app.description }}</p>
                <button class="btn btn-primary btn-sm mt-2" (click)="navigateToDetail(app.id)">View Details</button>
              </div>
            </div>
          </div>
        }
      </div>
    }

    @if (viewMode() === 'list') {
      <div class="mb-4">
        @for (app of moreApplications(); track app.id) {
          <div class="card mb-3 shadow-sm position-relative">
            @if (app.tags && app.tags.length > 0) {
              @for (tag of app.tags; track tag.id) {
                @if (tag.name === 'popular') {
                  <span class="badge bg-warning text-dark position-absolute top-0 end-0 m-2" style="font-size: 0.7rem;">{{ tag.displayName }}</span>
                }
              }
            }
            <div class="card-body">
              <div class="row align-items-center">
                <div class="col-auto">
                  <img [src]="app.logo" alt="" class="img-fluid" style="width: 80px; height: 80px; object-fit: contain;" />
                </div>
                <div class="col">
                  <h5 class="card-title mb-1">{{ app.displayName }}</h5>
                  @if (app.lifecycleState) {
                    <span class="badge bg-success mb-2">{{ formatLifecycleState(app.lifecycleState) }}</span>
                  }
                  <p class="card-text text-muted mb-0">{{ app.description }}</p>
                </div>
                <div class="col-auto">
                  <button class="btn btn-primary" (click)="navigateToDetail(app.id)">View Details</button>
                </div>
              </div>
            </div>
          </div>
        }
      </div>
    }

    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="currentPage() === 0">
          <button class="page-link" (click)="previousPage()" [disabled]="currentPage() === 0">
            ← Previous
          </button>
        </li>

        @for (page of [].constructor(totalPages()); track $index) {
          <li class="page-item" [class.active]="currentPage() === $index">
            <button class="page-link" (click)="goToPage($index)">
              {{ $index + 1 }}
            </button>
          </li>
        }

        <li class="page-item" [class.disabled]="currentPage() === totalPages() - 1">
          <button class="page-link" (click)="nextPage()" [disabled]="currentPage() === totalPages() - 1">
            Next →
          </button>
        </li>
      </ul>
    </nav>

    <!-- Advanced Options Section -->
    <div class="text-center py-5 mt-5">
      <h3 class="h4 mb-2 text-dark">Didn't find any suitable solution?</h3>
      <p class="text-dark mb-4">Choose from advanced options</p>
      <div class="d-flex justify-content-center gap-3 flex-wrap">
        <button class="btn text-dark" style="background-color: white; border: 1px solid #dee2e6;">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bezier2 me-2" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M1 2.5A1.5 1.5 0 0 1 2.5 1h1A1.5 1.5 0 0 1 5 2.5h4.134a1 1 0 1 1 0 1h-2.01q.269.27.484.605C8.246 5.097 8.5 6.459 8.5 8c0 1.993.257 3.092.713 3.7.356.476.895.721 1.787.784A1.5 1.5 0 0 1 12.5 11h1a1.5 1.5 0 0 1 1.5 1.5v1a1.5 1.5 0 0 1-1.5 1.5h-1a1.5 1.5 0 0 1-1.5-1.5H6.866a1 1 0 1 1 0-1h1.711a3 3 0 0 1-.165-.2C7.743 11.407 7.5 10.007 7.5 8c0-1.46-.246-2.597-.733-3.355-.39-.605-.952-1-1.767-1.112A1.5 1.5 0 0 1 3.5 5h-1A1.5 1.5 0 0 1 1 3.5zM2.5 2a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm10 10a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5z"/>
          </svg>
          Request Tailored Solution
        </button>
        <button class="btn text-dark" style="background-color: white; border: 1px solid #dee2e6;">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-upload me-2" viewBox="0 0 16 16">
            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
            <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"/>
          </svg>
          Upload Configuration
        </button>
        <button class="btn btn-primary">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-square me-2" viewBox="0 0 16 16">
            <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>
            <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
          </svg>
          Import Connector
        </button>
      </div>
    </div>
  }
  </div>
</div>
